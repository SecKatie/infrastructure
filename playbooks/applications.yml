---
# =============================================================================
# User Applications Playbook
# =============================================================================
# This playbook deploys end-user applications:
#   - Jellyfin (media server)
#   - Media Stack (Sonarr, Radarr, qBittorrent, Jackett)
#   - Paperless-ngx (document management)
#   - Immich (photo management)
#   - Agate (Gemini protocol server)
#   - Personal Site (static landing page at mulliken.net)
#
# Prerequisites:
#   - vars/immich_secrets.yml must exist and be encrypted with ansible-vault
#
# Usage:
#   ansible-playbook -i inventory/hosts.yml playbooks/applications.yml --ask-vault-pass
#
#   # Deploy only Jellyfin
#   ansible-playbook -i inventory/hosts.yml playbooks/applications.yml --tags jellyfin
#
#   # Deploy only media stack
#   ansible-playbook -i inventory/hosts.yml playbooks/applications.yml --tags media
#
#   # Deploy only Paperless
#   ansible-playbook -i inventory/hosts.yml playbooks/applications.yml --tags paperless
#
#   # Deploy only Immich
#   ansible-playbook -i inventory/hosts.yml playbooks/applications.yml --tags immich --ask-vault-pass
#
#   # Deploy only Agate
#   ansible-playbook -i inventory/hosts.yml playbooks/applications.yml --tags agate
#
#   # Deploy only Personal Site
#   ansible-playbook -i inventory/hosts.yml playbooks/applications.yml --tags personal-site
#
# Tags:
#   - applications: All user applications
#   - apps: All user applications (alias)
#   - jellyfin: Jellyfin media server
#   - media_server: Jellyfin media server (alias)
#   - media: Media management stack (Sonarr, Radarr, qBittorrent, Jackett)
#   - sonarr: Sonarr TV management
#   - radarr: Radarr movie management
#   - qbittorrent: qBittorrent download client
#   - jackett: Jackett indexer manager
#   - paperless: Paperless-ngx document management
#   - documents: Paperless-ngx document management (alias)
#   - immich: Immich photo management
#   - photos: Immich photo management (alias)
#   - agate: Agate Gemini protocol server
#   - gemini: Agate Gemini protocol server (alias)
#   - personal-site: Personal landing page (mulliken.net)
#   - personal: Personal landing page (alias)
# =============================================================================

- name: Deploy user applications
  hosts: localhost
  connection: local
  gather_facts: false
  tags: [applications, apps]
  vars_files:
    - vars/media_secrets.yml
    - vars/paperless_secrets.yml
    - vars/immich_secrets.yml
  roles:
    - role: app_jellyfin
      tags: [jellyfin, media_server]

    - role: app_media
      tags: [media, sonarr, radarr, qbittorrent, jackett]

    - role: app_paperless
      tags: [paperless, documents]

    - role: app_immich
      tags: [immich, photos]

    - role: install_agate
      tags: [agate, gemini]

    - role: app_personal_site
      tags: [personal-site, personal]
