---
# =============================================================================
# Observability Stack Playbook
# =============================================================================
# This playbook deploys the complete observability and monitoring stack:
#   - Victoria Metrics (Prometheus-compatible metrics storage)
#   - Node Exporter (System metrics collection)
#   - Perses (CNCF observability dashboard - Grafana replacement)
#
# Usage:
#   ansible-playbook -i inventory/hosts.yml playbooks/observability.yml
#
#   # Deploy only Victoria Metrics
#   ansible-playbook -i inventory/hosts.yml playbooks/observability.yml --tags victoria_metrics
#
#   # Deploy only Perses
#   ansible-playbook -i inventory/hosts.yml playbooks/observability.yml --tags perses
#
# Tags:
#   - observability: All observability components
#   - monitoring: All monitoring components
#   - victoria_metrics: Victoria Metrics deployment
#   - prometheus: Prometheus-compatible components
#   - node_exporter: Node Exporter DaemonSet
#   - perses: Perses dashboard (CNCF)
# =============================================================================

- name: Deploy observability stack
  hosts: localhost
  connection: local
  gather_facts: false
  tags: [observability, monitoring]
  roles:
    - role: observability_victoria_metrics
      tags: [victoria_metrics, prometheus]

    - role: observability_node_exporter
      tags: [node_exporter]

    - role: observability_perses
      tags: [perses]
